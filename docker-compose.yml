version: '3'

services:
    backend:
      restart: unless-stopped
      build:
          context: .
          dockerfile: ./docker/backend/Dockerfile
      volumes:

#      entrypoint: /app/docker/backend/wsgi-entrypoint.sh
      volumes:
        - .:/app
        - ./backend/djangoreactproject/django_static:/app/backend/djangoreactproject/django_static
      expose:
        - 8000
      depends_on:
        - db

    db:
      image: postgres:10.1-alpine

    nginx:
      restart: unless-stopped
      build:
          context: .
          dockerfile: ./docker/nginx/Dockerfile
      ports:
        - 80:80
      volumes:
        - static_volumes:/app/backend/djangoreactproject/django_static
        - ./docker/nginx/dev:/etc/nginx/conf.d
      depends_on:
        - backend
    
volumes:
   static_volumes: {}
